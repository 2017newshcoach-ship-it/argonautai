# Walkthrough: Deep Research Workflow (v3.5 Refactor)

## ðŸ—ï¸ Architectural Shift
Moved from "Form-First" (picking titles blindly) to **"Content-First"** (Research -> Architect -> Write).

### 1. Step 1: Deep Research (The Miner) â›ï¸
**Goal**: Gather raw "facts" and "context" before deciding the blog structure.
- **Input**: Topic (e.g., "Digital SAT Inference Strategy")
- **Action**:
    - **Web Search**: Google Search Tool via Gemini 3.0 Pro.
    - **Internal Search**: Scanning `knowledge_base.txt` (CollegeBoard Data).
    - **Human Curation**: User can **Delete** bad facts, **Edit** inaccuracies, or **Add** manual insights immediately.
- **Output**: `InsightCard` (Curated Facts + Sources).

### 2. Step 2: The Architect (The Surveyor) ðŸ“
**Goal**: Design a blueprint based on the gathered insight.
- **Input**: `InsightCard` + `Brand Guide` + `Style Guide`.
- **Action**:
    - Generates a **Blueprint** (Title, Flow, Section Outline).
    - **Blueprint Refinement (New)**:
        - **Section Editing**: User can modify Title, Description, and Key Sentence.
        - **Reordering**: Move sections Up/Down to fine-tune logic flow.
        - **Structure Control**: Add new sections or delete unnecessary ones.
    - Assigns specific "Source IDs" to each section to enforce fact usage.
- **Output**: `Blueprint` JSON.

### 3. Step 3: The Writer (The Builder) âœï¸
**Goal**: Execute the blueprint.
- **Input**: `Blueprint` (Authorization to write) + Guides.
- **Action**:
    - Writes the post section by section.
    - Strictly follows the "Key Sentence" and "Source ID" map from the Blueprint.
    - **Strict Adherence**: Writer follows manual edits from Step 2 without deviation.

---

## âœ… Verification Results
- **Script**: `scripts/verify_gen.ts`, `scripts/verify_edit.ts`, `scripts/verify_architect_edit.ts`
- **Scope**: End-to-End backend test (Research -> Blueprint -> Write).
- **Status**: **PASSED**
  - **Step 1 (Miner)**: Successfully gathered facts from Internal DB & Web.
  - **Step 1 (Curation)**: Manual Fact edits persist correctly.
  - **Step 2 (Architect)**: Generated a structured Blueprint with Source IDs.
  - **Step 2 (Refinement)**: **Manual Blueprint edits (Add/Edit/Reorder) are strictly respected by the Writer.**
  - **Step 3 (Builder)**: Generated a 3800+ char blog post strictly following the Blueprint.


## ðŸ“¸ Usage
1. Enter a topic in the new **Deep Research Console**.
2. Wait for the **Insight Card** to verify found facts.
3. Review the **Blueprint** generated by the architect.
4. **Refine**: Edit sections, reorder flow, or add new ideas.
5. Click "Approve & Write" to generate the final post.
